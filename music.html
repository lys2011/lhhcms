<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∏≠ÂõΩÂè§ÂÖ∏ÂêçÊõ≤</title>
    <style>
        body {
            background: linear-gradient(135deg, #2a2f4f 0%, #171b31 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .music-player {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
            width: 400px;
            padding: 20px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .song-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .song-title {
            font-size: 24px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 5px;
        }


        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            height: 4px;
            width: 100%;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .progress {
            background-color: #00bfff;
            border-radius: 5px;
            height: 100%;
            width: 0%;
            transition: width 0.1s linear;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            margin: 0 10px;
            padding: 10px;
            transition: color 0.2s ease;
        }

        .btn-big {
            font-size: 36px;
        }

        .btn:hover {
            color: #00bfff;
        }

        .playlist-btn {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            margin: 0 10px;
            padding: 10px;
            transition: color 0.2s ease;
        }

        .playlist-btn:hover {
            color: #00bfff;
        }

        .playlist-popup {
            position: relative;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            max-height: calc(7 * (12px * 2 + 6px * 2) + 10px); 
            overflow-y: auto; 
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.1);
            display: block; 
            z-index: 100;
            width: 100%;
            margin-top: 10px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .playlist-item {
            padding: 12px;
            margin: 6px 0;
            border-radius: 8px;
            color: #ffffff;
            cursor: pointer;
            transition: background-color 0.2s;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .playlist-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .playlist-item.active {
            background-color: rgba(255, 255, 255, 0.2);
            color: #00bfff;
        }

        .volume-container {
            display: flex;
            align-items: center;
            flex-basis: 100%;
            justify-content: center;
            margin-top: 10px;
        }

        .volume-btn {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            transition: color 0.2s ease;
        }

        .volume-btn:hover {
            color: #00bfff;
        }

        .volume-slider {
            width: 100px;
            margin-left: 10px;
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: #00bfff;
            border-radius: 50%;
            cursor: pointer;
        }

        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #00bfff;
            border-radius: 50%;
            cursor: pointer;
        }

        .mode-btn {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            margin: 0 10px;
            padding: 10px;
            transition: color 0.2s ease;
        }

        .mode-btn.active {
            color: #00bfff;
        }
    </style>
</head>

<body>
    <div class="music-player">
        <div class="song-info">
            <div class="song-title">--</div>
        </div>
        <div class="progress-container" id="progressContainer">
            <div class="progress" id="progress"></div>
        </div>
        <div class="controls">
            <button class="btn" id="prevBtn">‚èÆ</button>
            <button class="btn btn-big" id="playPauseBtn">‚ñ∂</button>
            <button class="btn" id="nextBtn">‚è≠</button>
            <button class="mode-btn" id="playModeBtn">üîÅ</button>
            <div class="volume-container">
                <button class="volume-btn" id="volumeBtn">üîä</button>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="1">
            </div>
        </div>
        <div id="modeTip" style="text-align: center; color: #cccccc; margin-top: 10px;"></div>
        <div class="playlist-popup" id="playlistPopup"></div>
    </div>
    <audio id="audioPlayer">
    </audio>

    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progress = document.getElementById('progress');
        const songTitle = document.querySelector('.song-title');
        const playlistPopup = document.getElementById('playlistPopup');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        const playModeBtn = document.getElementById('playModeBtn');
        const modeTip = document.getElementById('modeTip');

        const audioList = [
            {
                title: 'È´òÂ±±ÊµÅÊ∞¥ (Âè§Á≠ùÁã¨Â•è)',
                src: 'https://music.163.com/song/media/outer/url?id=2100710552.mp3' 
            },
            {
                title: 'Ê¢ÖËä±‰∏âÂºÑ',
                src: 'https://music.163.com/song/media/outer/url?id=5274365.mp3' 
            },
            {
                title: 'Â§ïÈò≥ÁÆ´Èºì (ÁêµÁê∂)',
                src: 'https://music.163.com/song/media/outer/url?id=5273863.mp3' 
            },
            {
                title: 'Ê±âÂÆ´ÁßãÊúà',
                src: 'https://music.163.com/song/media/outer/url?id=128613.mp3' 
            },
            {
                title: 'ÂπøÈôµÊï£',
                src: 'https://music.163.com/song/media/outer/url?id=396334.mp3' 
            },
            {
                title: 'Âπ≥Ê≤ôËêΩÈõÅ',
                src: 'https://music.163.com/song/media/outer/url?id=396334.mp3' 
            },
            {
                title: 'Èò≥Êò•ÁôΩÈõ™',
                src: 'https://music.163.com/song/media/outer/url?id=1914674029.mp3' 
            },
            {
                title: 'Ê∏îÊ®µÈóÆÁ≠î',
                src: 'https://music.163.com/song/media/outer/url?id=1895373234.mp3' 
            },
            {
                title: 'ËÉ°Á¨≥ÂçÅÂÖ´Êãç',
                src: 'https://music.163.com/song/media/outer/url?id=5281526.mp3' 
            },
            {
                title: 'ÂçÅÈù¢Âüã‰ºè',
                src: 'https://music.163.com/song/media/outer/url?id=1895377048.mp3' 
            }
        ];

        let currentIndex = 0;
        let isPlaying = false;
        let playMode = 0; // Êí≠ÊîæÊ®°ÂºèÔºå0 ‰∏∫È°∫Â∫èÊí≠ÊîæÔºå1 ‰∏∫ÂçïÊõ≤Âæ™ÁéØ

        function renderPlaylist() {
            playlistPopup.innerHTML = audioList.map((audio, index) => `
                <div class="playlist-item ${index === currentIndex ? 'active' : ''}" data-index="${index}">
                    <div>${audio.title}</div>
                    <!-- Âà†Èô§Ëâ∫ÊúØÂÆ∂‰ø°ÊÅØÊòæÁ§∫ -->
                    <!-- <div class="artist">${audio.artist}</div> -->
                </div>
            `).join('');

            document.querySelectorAll('.playlist-item').forEach(item => {
                item.addEventListener('click', () => {
                    const index = parseInt(item.dataset.index);
                    currentIndex = index;
                    loadAudio(currentIndex);
                    playAudio();
                    renderPlaylist();
                });
            });
        }

        loadAudio(currentIndex);
        renderPlaylist();
        updateModeBtnState();

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp') {
                e.preventDefault();
                currentIndex = (currentIndex - 1 + audioList.length) % audioList.length;
                renderPlaylist();
                scrollToSelectedItem();
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                currentIndex = (currentIndex + 1) % audioList.length;
                renderPlaylist();
                scrollToSelectedItem();
            } else if (e.key === 'Enter') {
                loadAudio(currentIndex);
                playAudio();
            }
        });

        function scrollToSelectedItem() {
            const playlistPopup = document.getElementById('playlistPopup');
            const selectedItem = playlistPopup.querySelector('.playlist-item.active');
            if (selectedItem) {
                const playlistScrollTop = playlistPopup.scrollTop;
                const playlistHeight = playlistPopup.clientHeight;
                const itemOffsetTop = selectedItem.offsetTop;
                const itemHeight = selectedItem.offsetHeight;

                if (itemOffsetTop + itemHeight > playlistScrollTop + playlistHeight) {
                    playlistPopup.scrollTop = itemOffsetTop + itemHeight - playlistHeight;
                } 
                else if (itemOffsetTop < playlistScrollTop) {
                    playlistPopup.scrollTop = itemOffsetTop;
                }
            }
        }

        playPauseBtn.addEventListener('click', () => {
            if (isPlaying) {
                pauseAudio();
            } else {
                playAudio();
            }
        });

        prevBtn.addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + audioList.length) % audioList.length;
            loadAudio(currentIndex);
            playAudio();
            renderPlaylist();
        });

        nextBtn.addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % audioList.length;
            loadAudio(currentIndex);
            playAudio();
            renderPlaylist();
        });

        progressContainer.addEventListener('click', (e) => {
            const width = progressContainer.clientWidth;
            const clickX = e.offsetX;
            const duration = audioPlayer.duration;
            audioPlayer.currentTime = (clickX / width) * duration;
        });

        audioPlayer.addEventListener('timeupdate', updateProgress);

        audioPlayer.addEventListener('ended', handleAudioEnded);

        function loadAudio(index) {
            const audio = audioList[index];
            audioPlayer.src = audio.src;
            songTitle.textContent = audio.title;
        }

        function playAudio() {
            audioPlayer.play();
            playPauseBtn.textContent = '‚è∏';
            isPlaying = true;
        }

        function pauseAudio() {
            audioPlayer.pause();
            playPauseBtn.textContent = '‚ñ∂';
            isPlaying = false;
        }

        function updateProgress(e) {
            const { duration, currentTime } = e.srcElement;
            const progressPercent = (currentTime / duration) * 100;
            progress.style.width = `${progressPercent}%`;
        }

        function handleAudioEnded() {
            if (playMode === 0) {
                nextTrack();
            } else if (playMode === 1) {
                audioPlayer.currentTime = 0;
                playAudio();
            }
        }

        function nextTrack() {
            currentIndex = (currentIndex + 1) % audioList.length;
            loadAudio(currentIndex);
            playAudio();
            renderPlaylist();
        }

        audioPlayer.volume = volumeSlider.value;

        volumeSlider.addEventListener('input', () => {
            audioPlayer.volume = volumeSlider.value;
            if (volumeSlider.value === '0') {
                volumeBtn.textContent = 'üîá';
            } else {
                volumeBtn.textContent = 'üîä';
            }
        });

        volumeBtn.addEventListener('click', () => {
            if (audioPlayer.volume > 0) {
                audioPlayer.volume = 0;
                volumeSlider.value = 0;
                volumeBtn.textContent = 'üîá';
            } else {
                audioPlayer.volume = 1;
                volumeSlider.value = 1;
                volumeBtn.textContent = 'üîä';
            }
        });

        playModeBtn.addEventListener('click', () => {
            playMode = (playMode + 1) % 2; 
            updateModeBtnState();
        });

        function updateModeBtnState() {
            if (playMode === 0) {
                playModeBtn.textContent = 'üîÅ';
                modeTip.textContent = 'È°∫Â∫èÊí≠Êîæ';
            } else {
                playModeBtn.textContent = 'üîÇ';
                modeTip.textContent = 'ÂçïÊõ≤Âæ™ÁéØ';
            }
            playModeBtn.classList.toggle('active', playMode === 1);
        }
    </script>
</body>

</html>
